# 分机管理接口
<!-- toc -->

## 新建分机

### URL

```
POST {BASE_URL}/callcenter/extension
```

### 请求参数

参数                  | 有效值范围            | 必填   | 说明
--------------------- | --------------------- | ------ | ----------------------------------------
`type`                | 整数，分机类型枚举值  | √      | 分机类型
`user`                | 6~12字母数字位字符串  |        | SIP 注册用户名，仅用于 `type==1`的情况
`password`            | 6~12字母数字位字符串  |        | SIP 注册用密码，仅用于 `type==1`的情况
`ipaddr`              | `<ip>[:port]`         |        | SIP 网关IP地址与端口，默认5060，仅用于 `type==2`的情况
`telnum`              | 电话号码              |        | 仅用于 `type==3` 的情况

#### `user`参数
注册用户名。

云呼你平台中， SIP 分机的注册用户名只能是数字，这个数字被成为号码。

目前，呼叫中心应用的 SIP 分机用户名由“号码前缀”和“自定义号码”两个部分组成。
前缀部分是4位长度的数字，在新建应用时，系统自动分配。
其格式正则表达式：

```js
/([1-5][0-9][0-9][0-9])([0-9]+)/g
```

在新建分机时，`user`的值 **必须** 符合该格式，且其前4位部分 **必须** 与该应用的分机前缀一致。

#### `type`参数
分机类型

 枚举值 | 说明
------- | --------------
 `1`    | SIP 终端。如IP电话、软电话。
 `2`    | SIP 网关。
 `3`    | 电话。普通电话，如手机、固话。

!!! warning
  目前仅仅支持 `1`

### 回复参数

参数     | 有效值范围   | 说明                           
-------- | ------------ | -----------------------------
`code`   | 数字文本     | 状态码，全0表示正确
`msg`    | 文本         | 返回情况说明
`data`   | JSON 对象    | 返回数据对象，参见[data对象属性列表](#data对象属性列表)

#### data对象属性列表

属性     | 有效值范围      | 说明
-------- | --------------- | --------
`id`     | UUID HEX 字符串 | 新建的分机的 ID

## 删除分机

### 请求

#### URL

```
DELETE {BASE_URL}/callcenter/extension/{extension_id}
```

#### 请求参数列表

参数                   | 有效值范围          | 是否必填  | 说明
---------------------- | ------------------- | --------- | ----------------------------------------
`id`                   | UUID HEX 字符串     | √         | 分机ID

### 回复

#### 回复参数列表

参数     | 有效值范围   | 说明
-------- | ------------ | -----------------------------
`code`   | 数字文本     | 状态码，全0表示正确
`msg`    | 文本         | 返回情况说明
`data`   | JSON 对象    | `null`

#### 参数详解

##### data对象属性列表

无

## 列出分机

### 请求

#### URL

```
GET {BASE_URL}/callcenter/extension/{extension_id}
```

#### 请求参数列表

TODO: 分页参数

### 回复

#### 回复参数列表

 参数     | 有效值范围   | 说明
--------- | ------------ | -----------------------------
`code`    | 数字文本     | 状态码，全0表示正确
`msg`     | 文本         | 返回情况说明
`data`    | JSON 数组    | 数组元素是分机对象，见参数详解

#### 参数详解

##### data数组元素属性列表

参数                  | 有效值范围            | 说明
--------------------- | --------------------- | ----------------------------------------
`type`                | 整数，分机类型枚举值  | 分机类型
`user`                | 6~12字母数字位字符串  | SIP 注册用户名，仅用于 `type==1`的情况
`password`            | 6~12字母数字位字符串  | SIP 注册用密码，仅用于 `type==1`的情况
`ipaddr`              | `<ip>[:port]`         | SIP 网关IP地址与端口，默认5060，仅用于 `type==2`的情况
`telnum`              | 电话号码              | 仅用于 `type==3` 的情况
