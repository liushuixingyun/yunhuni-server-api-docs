# 坐席交谈接口

## 坐席加入交谈

```
POST {BASE_URL}/callcenter/conversation/{conversationId}/attachAgent
```

参数                   | 有效值范围            | 必填 | 说明
---------------------- | ----------------------| ---- | ----------------------------------------
`agentId`              |                       | √    |
`voiceIoMode`          | Integer               |      | 录放音模式

`voiceIoMode`:

值     | 说明
------ | ---------
`1`    | 放音+收音(默认)
`2`    | 收音
`3`    | 放音
`4`    | 无

设置为4，就相当于保持

> - 如果坐席的分机没有被连接，平台将自动呼叫坐席分机，并等待其接通。
> - 调用后会在自动退出当前活动`conversation`。如果想要不退出，就需要先调用保持。

## 坐席退出交谈
退出后，如果坐席没有其它`conversation`，平台将自动挂断坐席分机。

```
POST {BASE_URL}/callcenter/conversation/{conversationId}/dettachAgent
```

参数                   | 有效值范围            | 必填 | 说明
---------------------- | ----------------------| ---- | ----------------------------------------
`conversationId`       | 字符/数字字符串       | √    |

## 邀请坐席加入交谈
按照排队规则呼叫目标坐席，连接后加入交谈。

```
POST {BASE_URL}/callcenter/conversation/{conversationId}/inviteAgent
```

参数                   | 有效值范围            | 必填 | 说明
---------------------- | ----------------------| ---- | ----------------------------------------
`enqueue`              | XML 字符串            | √    | 目标坐席选择条件（同排队）
`backgroud`            | Boolean               |      | 拨打坐席是否采用“背景”模式。默认 `false`
`voiceIoMode`          | Integer               |      | 加入后的录放音模式

`voiceIoMode`:

值     | 说明
------ | ---------
`1`    | 放音+收音(默认)
`2`    | 收音
`3`    | 放音
`4`    | 无

设置为4，就相当于保持

> - 只有空闲的目标坐席才有可能被排队匹配到

`backgroud`:

> - `true`: 邀请时，会议听到排队提示音
> - `false`: 邀请时，会议听到不到排队提示音


## 邀请外线加入交谈
按照排队规则呼叫目标坐席，连接后加入交谈。

```
POST {BASE_URL}/callcenter/conversation/{conversationId}/inviteOut
```

参数                   | 有效值范围            | 必填 | 说明
---------------------- | ----------------------| ---- | ----------------------------------------
`to`                   | 电话号码              | √    | 被叫号码
`from`                 | 电话号码              |      | 主叫号码
`max_dial_seconds`     | 正整数                |      | 最大拨号等待时间
`max_answer_seconds`   | 正整数                | √    | 最大通话时间
`backgroud`            | Boolean               |      | 拨打坐席是否采用“背景”模式。默认 `false`
`voiceIoMode`          | Integer               |      | 加入后的录放音模式

`voiceIoMode`:

值     | 说明
------ | ---------
`1`    | 放音+收音(默认)
`2`    | 收音
`3`    | 放音
`4`    | 无

`backgroud`:

> - `true`: 邀请时，会议听到拨号音、回铃音
> - `false`: 邀请时，会议听不到拨号音、回铃音
