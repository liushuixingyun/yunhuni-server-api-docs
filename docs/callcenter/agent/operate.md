# 坐席操作
<!-- toc -->

## 拒绝排队任务

```
POST {BASE_URL}/callcenter/{callcenter_id}/agent/{agent_id}/reject
```

参数                   | 有效值范围            | 必填 | 说明
---------------------- | ----------------------| ---- | ----------------------------------------
`queue_task_id`        |                       | √    | 排队任务ID
`data`                 | String                |      | 传回 IVR 的事件参数数据

坐席也可以直接在分机上执行“拒接”操作，或者不接听。
该API的不通在于，它可以让拒绝操作带着`data`参数返回 IVR ，便于 IVR 做进一步的处理。

## 呼叫外线
按排队规则呼叫目标电话号码，接通后与当前坐席形成新的交谈。

> - 如果发起坐席的分机没有处于任何 `conversation` 中（表明分机没有被连接），平台将自动呼叫坐席分机，并等待其接通。
> - 如果发起坐席的分机处于某个 `conversation` 中，平台会将该分机在所有的交谈中都置于“不听不说”状态，并在新的交谈中呼叫外线。

```
POST {BASE_URL}/callcenter/{callcenter_id}/agent/{agent_id}/call_out
```

参数                   | 有效值范围            | 必填 | 说明
---------------------- | ----------------------| ---- | ----------------------------------------
`to`                   | 电话号码              | √    | 被叫号码
`from`                 | 电话号码              |      | 主叫号码
`max_dial_seconds`     | 正整数                |      | 最大拨号等待时间
`max_answer_seconds`   | 正整数                | √    | 最大通话时间

## 呼叫其它坐席
按排队规则呼叫目标坐席，接通后与当前坐席形成新的交谈。

> - 只有空闲的目标坐席才有可能被排队匹配到
> - 如果发起坐席的分机没有处于任何`conversation`中（表明分机没有被连接），平台将自动呼叫坐席分机，并等待其接通。
> - 如果发起坐席的分机处于某个 `conversation` 中，平台会将该分机在所有的交谈中都置于“不听不说”状态，并在新的交谈中排队并呼叫目标坐席的分机。

```
POST {BASE_URL}/callcenter/{callcenter_id}/agent/{agent_id}/call_agent
```

参数                   | 有效值范围            | 必填 | 说明
---------------------- | ----------------------| ---- | ----------------------------------------
`enqueue`              | XML 字符串            | √    | 目标坐席选择条件（同排队）

## 前转到其它坐席
即`forward`——在排队任务到达坐席之后，接受任务之前，将当前排队转移到别的坐席。

这实际上是重新排队！

```
POST {BASE_URL}/callcenter/{callcenter_id}/agent/{agent_name}/forward_agent
```

参数                   | 有效值范围            | 必填 | 说明
---------------------- | ----------------------| ---- | ----------------------------------------
`queue_task_id`        |                       | √    |
`enqueue`              | XML 字符串            | √    | 目标坐席选择条件（同排队）

## 后转到其它坐席

即`transfer`。坐席退出该交谈，并在交谈上排队。

```
POST {BASE_URL}/callcenter/{callcenter_id}/agent/{agent_name}/xfer_agent
```

参数                   | 有效值范围            | 必填 | 默认值     | 说明
---------------------- | ----------------------| ---- | ---------- | -----------------------------
`conversation_id`      |                       | √    |            |
`queue`                | XML 字符串            | √    |            | 目标坐席选择条件（同排队）

## 后转到外线

即`transfer`。坐席退出该交谈，并在交谈上呼叫外线。

```
POST {BASE_URL}/callcenter/{callcenter_id}/agent/{agent_name}/xferOut
```

参数                   | 有效值范围            | 必填 | 默认值     | 说明
---------------------- | ----------------------| ---- | ---------- | -----------------------------
`conversation_id`      |                       | √    |            |
`to`                   | 电话号码              | √    |            | 被叫号码
`from`                 | 电话号码              |      |            | 主叫号码
`max_dial_seconds`     | 正整数                |      |            | 最大拨号等待时间
`max_answer_seconds`   | 正整数                | √    |            | 最大通话时间

## 保持
将坐席在 `conversation` 中设置于“不听不说”。
如果此时`conversation`只剩下一个呼叫，平台将在交谈中播放保持音。

注意同一个时间点，坐席的分机呼叫只能在一个交谈中处于非“不听不说”状态。

```
POST {BASE_URL}/callcenter/{callcenter_id}/agent/{agent_name}/pause
```

参数                   | 有效值范围            | 必填 | 默认值     | 说明
---------------------- | ----------------------| ---- | ---------- | -----------------------------
`conversation_id`      |                       | √    |            |

这相当于调用“设置听/说模式”，将模式设置为`4`。

## 取消保持
将坐席在 `conversation` 中设置为非“即听又说”状态。

注意同一个时间点，坐席的分机呼叫只能在一个交谈中处于非“不听不说”状态。

```
POST {BASE_URL}/callcenter/{callcenter_id}/agent/{agent_name}/resume
```

参数                   | 有效值范围            | 必填 | 默认值     | 说明
---------------------- | ----------------------| ---- | ---------- | -----------------------------
`conversation_id`      |                       |  √   |            |
`mode`                 | Integer               |      | `1`        | 恢复后的听/说模式，不能是不听不说

`mode` **必须** 是 1 ~ 3

> - 如果坐席处于多个`conversation`中，同时只能有一个处于不是 *不听不说* 状态，该交谈是该坐席当前活动交谈。
> - 调用该API口，平台自动将该坐席在其它交谈的模式全部变为 *不听不说* 。
