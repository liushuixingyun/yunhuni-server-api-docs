# 语音通知

## 请求

### URL

```
POST {BASE_URL}/call/notify_call
```

### 请求参数列表

| 参数                  | 有效值范围       | 是否必填              | 说明                                       |
| ------------------- | ----------- | ----------------- | ---------------------------------------- |
| `from`              | 电话号码字符串     | 选填，默认为`使用系统主叫`    | 主叫号码，只能填租用的号码，不填平台会自动选择一个可用的             |
| `to`                | 电话号码字符串     | **必填**            | 被叫号码                                     |
| `max_dial_duration` | 正整数         | 选填，默认为`45`        | 最大拨号等待时间（秒），默认50秒                        |
| `repeat`            | 自然数         | 选填，默认为`0`         | 重复播放次数。自然数范围区间为`[0,10]`  。例子：`1`表示播放两次（重复一次）；`2`表示播放三次（重复两次），依次类推。注意，0表示播放一次，不重复播放。 |
| `files`             | 提示音文件名字符串   | 选填，无默认值，看备注       | 提示音文件，文件名或者文件名列表，文件名为开发者用户中心的放音文件名。当有多个文件时，用`\|`链接。如：文件名1\|文件名2。 |
| `play_content`      | 二元数组        | 选填，无默认值，看备注       | 动态播放内容，可以是数字、日期、金额。参见`参数详解`的`动态播放内容详解`   |
| 动态播放内容，可以是数字、日期、金额  | 不超过128字符字符串 | 选填，默认`null`，无用户数据 | 用户数据，该呼叫的后续事件将带有该参数                      |

**注意**：其中`files`和`play_content`这个两个字段，不能同时为空，至少需要上送一个字段。

两者都被赋值的情况下，首先播放 `files` 指定的文件，然后才播放 `play_content` 中的内容。

### 参数详解

#### 动态播放内容详解

动态播放内容，可以是数字、日期、金额

内容是一个二元数组，且数组长度最大是`10`。

二元数组代码说明：

```java
//目标数组-是一个二元数组
String[][] aim = new String[10][3];//最大是10,子数组长度只能是3
//子数组-是一个字符串数组，且长度为3
String[] body = new String[3]{"放音内容(字符串)","放音类型枚举值（整形）","放音选项字符串"};

```

字数组

| 数组下标 | 有效值范围 | 是否必填    | 内容说明                           |
| ---- | ----- | ------- | ------------------------------ |
| 0    | 字符串   | **必填 ** | 放音内容（字符串）                      |
| 1    | 枚举    | **必填 ** | 放音类型枚举值，参见`放音类型枚举值定义表`         |
| 2    | 字符串   | **必填 ** | 放音选项字符串，放音选项字符串目前没有作用，一律填写空字符串 |

#### 放音类型枚举值定义表

| 枚举值  | 说明                                       |
| ---- | ---------------------------------------- |
| `0`  | 文件播放。此时，放音内容应是文件名字符串。                    |
| `1`  | 数字播放。此时，放音内容应是十进制整数。                     |
| `2`  | 数值播放。此时，放音内容应是十进制整数或者浮点数。                |
| `3`  | 金额播放。此时，放音内容应是十进制整数或者浮点数。                |
| `4`  | 日期时间播放。格式是 `"YYYY-mm-DD"` 或者 `"HH:MM:SS"` 或者 `"YYYY-mm-DD HH:MM:SS"`，参见`支持日期格式列表` |
| `，5` | 时长播放。此时，放音内容是文件名字符串。参见`时长播放格式列表`         |

#### 支持日期格式列表

| 格式                    | 说明                                       |
| --------------------- | ---------------------------------------- |
| `YYYY-mm-dd HH:MM:SS` | 完整的日期时间。如： 2012-9-8 1:5:3 读作 “二零一二年九月八日一点五分三秒”， 1980-01-01 01:23:35 读作 “一九八零年一月一日一点二十三分三十五秒”。 |
| `YYYY-mm-dd HH:MM`    | 精确到分钟的日期时间。如： 2012-9-8 1:5 读作 “二零一二年九月八日一点五分”， 1980-01-01 01:23 读作 “一九八零年一月一日一点二十三分”。 |
| `YYYY-mm-dd HH:MM`    | 精确到分钟的日期时间。如： 2012-9-8 1:5 读作 “二零一二年九月八日一点五分”， 1980-01-01 01:23 读作 “一九八零年一月一日一点二十三分”。 |
| `YYYY-mm-dd`          | 完整的日期时间。如： 2012-9-8 读作 “二零一二年九月八日”， 1980-01-01 读作 “一九八零年一月一日”。 |
| `YYYY-mm`             | 精确到月份的日期。如： 2012-9 读作 “二零一二年九月”， 1980-01 读作 “一九八零年一月”。 |
| `HH:MM:SS`            | 精确到秒的时间。如： 1:5:3 读作 “一点五分三秒”， 01:23:35 读作 “一点二十三分三十五秒”。 |
| `HH:MM`               | 精确到分钟的时间。如： 1:5 读作 “一点五分”， 01:23 读作 “一点二十三分”。 |

#### 时长播放格式列表

| 格式       | 说明                                       |
| -------- | ---------------------------------------- |
| HH:MM:SS | 精确到秒的时长。如： 1:5:3 读作 “一小时五分钟三秒”， 01:23:35 读作 “一小时二十三分钟三十五秒”。 |
| HH:MM    | 精确到分钟的时长。如： 1:5 读作 “一小时五分钟”， 01:23 读作 “一小时二十三分钟”。 |

**注意** ：时分秒的数值区间必须处于 0 ~ 99 之间。

## 响应

### 响应参数列表

| 属性     | 有效值范围   | 说明                            |
| ------ | ------- | ----------------------------- |
| `code` | 数字文本    | 状态码，全0表示正确                    |
| `msg`  | 文本      | 返回情况说明                        |
| `data` | JSON 对象 | 返回数据对象，参见`参数详解`中的`data对象属性列表` |

### 参数详解

#### `data` 对象属性列表

| 属性       | 有效值范围        | 说明       |
| -------- | ------------ | -------- |
| `callId` | UUID HEX 字符串 | 此次呼叫的 ID |

## 事件

见 [外呼通知事件](../evt/simple_call/notify_call.md)

## 示例

请求:
```http
POST {BASE_URL}/account/{account_id}/call/duo_callback HTTP/1.1
Host: api.yunhuni.com
Content-Type: application/json
Accept-Type: application/json
Content-Length: xxx
{
  "from": "075589877675",
  "to": "13692206627",
  "max_dial_duration": 60,
  "repeat": 1,
  "play_file": ["你好.wav", "你的余额是.wav"],
  "play_content": [
    ["你好.wav", 1, ""],
    ["你的欠款是.wav", 1, ""],
    ["3245.24", 3, ""],
    ["还款日是.wav", 0, ""],
    ["2020-05-09", 4, ""],
    ["bye.wav", 0, ""]
  ],
  "user_data": "your data"
}
```

响应:
```http
HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: xxx

{
  "code": "000000",
  "msg": "请求成功",
  "data": {
    "callId": "89d716b2fc23ebff7a0086482bda8942"
  }
}
```
