# 语音通知

## 请求

### URL

```
POST {BASE_URL}/account/{account_id}/call/notify_call
```

### 请求对象属性列表

|          参数        |       有效值范围          |      默认值          |         说明          |
| ------------------- |-------------------------- | ------------------- | --------------------- |
| `from`              | 电话号码字符串             | `null`: 使用系统主叫 | 主叫号码，只能填租用的号码，不填平台会自动选择一个可用的        |
| `to`                | 电话号码字符串             |                     | 被叫号码                                |
| `max_dial_duration` | 正整数                    | `45`                | 最大拨号等待时间（秒），默认50秒                   |
| `repeat`            | 非负整数                  | `0`                 | 重复播放次数。`1`表示播放两次（重复一次）；`2`表示播放三次（重复两次）。注意，0表示播放一次，不重复播放。 |
| `play_content`      | 数组或者文件名字符串       |                     | 语音通知的播放内容 |
| `user_data`         | 不超过128字符字符串       | `null`: 无用户数据    | 用户数据，该呼叫的后续事件将带有该参数 |

### 属性详解

#### `play_content`
该属性应是一个字符串或者 JSON 数组。

当它是字符串时，表示播放该字符串指定的录音文件名。

当它是数组时，数组内的元素（最多10个元素）应是一个三元数组，这3个元素的含义是:

| 序号 |  说明  |
| ---- | ------ |
| 0    | 放音内容(字符串) |
| 1    | 放音类型枚举值（整形） |
| 2    | 放音选项字符串 |

其中，放音选项字符串目前没有作用，一律填写空字符串。

放音类型枚举值定义如下:

| 枚举值 |  说明 |
| ----- | ----- |
| `0`   | 文件播放。此时，放音内容应是文件名字符串。 |
| `1`   | 数字播放。此时，放音内容应是十进制整数。 |
| `2`   | 数值播放。此时，放音内容应是十进制整数或者浮点数。 |
| `3`   | 金额播放。此时，放音内容应是十进制整数或者浮点数。 |
| `4`   | 日期时间播放。格式是 `"YYYY-mm-DD"` 或者 `"HH:MM:SS"` 或者 `"YYYY-mm-DD HH:MM:SS"` |
| `5`   | 时长播放。此时，放音内容是文件名字符串。 |

日期时间的格式有：

* YYYY-mm-dd HH:MM:SS

    完整的日期时间。如： 2012-9-8 1:5:3 读作 “二零一二年九月八日一点五分三秒”， 1980-01-01 01:23:35 读作 “一九八零年一月一日一点二十三分三十五秒”。

* YYYY-mm-dd HH:MM

    精确到分钟的日期时间。如： 2012-9-8 1:5 读作 “二零一二年九月八日一点五分”， 1980-01-01 01:23 读作 “一九八零年一月一日一点二十三分”。

* YYYY-mm-dd HH:MM

    精确到分钟的日期时间。如： 2012-9-8 1:5 读作 “二零一二年九月八日一点五分”， 1980-01-01 01:23 读作 “一九八零年一月一日一点二十三分”。

* YYYY-mm-dd

    完整的日期时间。如： 2012-9-8 读作 “二零一二年九月八日”， 1980-01-01 读作 “一九八零年一月一日”。

* YYYY-mm

    精确到月份的日期。如： 2012-9 读作 “二零一二年九月”， 1980-01 读作 “一九八零年一月”。

* HH:MM:SS

    精确到秒的时间。如： 1:5:3 读作 “一点五分三秒”， 01:23:35 读作 “一点二十三分三十五秒”。

* HH:MM

    精确到分钟的时间。如： 1:5 读作 “一点五分”， 01:23 读作 “一点二十三分”。

时长播放的格有：

* HH:MM:SS

    精确到秒的时长。如： 1:5:3 读作 “一小时五分钟三秒”， 01:23:35 读作 “一小时二十三分钟三十五秒”。

* HH:MM

    精确到分钟的时长。如： 1:5 读作 “一小时五分钟”， 01:23 读作 “一小时二十三分钟”。

**注意** 时分秒的数值区间必须处于 0 ~ 99 之间。

## 回复

### 回复对象属性列表

属性      |   有效值范围    |                   说明                                
--------- | -------------- | -------------------------------------
`code`    | 数字文本       | 状态码，全0表示正确
`msg`     | 文本           | 返回情况说明
`data`    | JSON 对象      | 返回数据对象

### `data` 对象属性列表

属性       |   有效值范围   |                   说明                                
--------- | -------------- | -------------------------------------
`callId`  | UUID HEX 字符串 | 此次呼叫的 ID

## 事件

见 [外呼通知事件](../evt/simple_call/notify_call.md)

## 示例

请求:
```http
POST {BASE_URL}/account/{account_id}/call/duo_callback HTTP/1.1
Host: api.yunhuni.com
Content-Type: application/json
Accept-Type: application/json
Content-Length: xxx
{
  "from": "075589877675",
  "to": "13692206627",
  "max_dial_duration": 60,
  "repeat": 1,
  "play_file": ["你好.wav", "你的余额是.wav"],
  "play_content": [
    ["你好.wav", 1, ""],
    ["你的欠款是.wav", 1, ""],
    ["3245.24", 3, ""],
    ["还款日是.wav", 0, ""],
    ["2020-05-09", 4, ""],
    ["bye.wav", 0, ""]
  ],
  "user_data": "your data"
}
```

回复:
```http
HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: xxx

{
  "code": "000000",
  "msg": "请求成功",
  "data": {
    "callId": "89d716b2fc23ebff7a0086482bda8942"
  }
}
```
